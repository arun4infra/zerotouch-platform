kind: Cluster
apiVersion: kind.x-k8s.io/v1alpha4
name: zerotouch-preview
nodes:
  - role: control-plane
    # Increase resources for preview environment
    kubeadmConfigPatches:
    - |
      kind: ClusterConfiguration
      controllerManager:
        extraArgs:
          bind-address: "0.0.0.0"
      scheduler:
        extraArgs:
          bind-address: "0.0.0.0"
      etcd:
        local:
          dataDir: "/tmp/etcd"
    extraMounts:
    - hostPath: /repo
      containerPath: /repo
      readOnly: true
    extraPortMappings:
      # NATS client port
      - containerPort: 30080
        hostPort: 4222
        protocol: TCP
      # PostgreSQL port
      - containerPort: 30432
        hostPort: 5432
        protocol: TCP
      # Dragonfly (Redis-compatible) port
      - containerPort: 30379
        hostPort: 6379
        protocol: TCP
